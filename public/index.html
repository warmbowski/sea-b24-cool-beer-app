<html>
<head>
  <style type="text/css"> /*Style HEADLINE from http://3.7designs.co/blog/2008/06/10-examples-of-beautiful-css-typography-and-how-they-did-it/*/
    
    .big {
      font-family: Georgia,"Times New Roman",serif;
      font-size: 80px;
      font-weight: bold;
      color: #600;
      text-transform: uppercase;
      letter-spacing: 1px
    }
  </style>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script>
  // geolocation script from https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation
    function geoFindMe() {
      var output = document.getElementById("out");
      var map = document.getElementById("map");
      var list = document.getElementById("list");
      
      if (!navigator.geolocation){
        output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
        return;
      }

      function success(position) {
        var latitude  = position.coords.latitude;
        var longitude = position.coords.longitude;

        $.ajax({
          type: "POST",
          url: 'http://localhost:3000/',
          data: {lat: latitude, lon: longitude},
          success: function(data) {
            console.log(data)
            output.innerHTML = '<p>' + data.msg + '</p>';
            list.innerHTML = '<p>You may store ' + data.beer_list + ' on your porch right now.</p>';
            $("#out").toggleClass('big');
            
          }
        });

        var img = new Image();
        img.src = "http://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + 
          longitude + "&zoom=13&size=300x300&sensor=false";

        map.appendChild(img);
      };

      function error() {
        output.innerHTML = "Unable to retrieve your location";
      };

      output.innerHTML = "<p>Thinkingâ€¦</p>";

      navigator.geolocation.getCurrentPosition(success, error);
    }
    window.onload = geoFindMe;
  </script>
</head>
<body>
  <div id="out"></div>
  <div id="list"></div>
  <div id="map"></div>
</body>